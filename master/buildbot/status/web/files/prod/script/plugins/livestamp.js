// Livestamp.js / v1.1.2 / (c) 2012 Matt Bradley / MIT License

(function(e,t){var n=1e3,r=!1,i=e([]),s=function(){a.resume()},o=function(n,r){var s=n.data("livestampdata");typeof r=="number"&&(r*=1e3),n.removeAttr("data-livestamp").removeData("livestamp"),r=t(r);if(t.isMoment(r)&&!isNaN(+r)){var o=e.extend({},{original:n.contents()},s);o.moment=t(r),n.data("livestampdata",o).empty(),i.push(n[0])}},u=function(){if(r)return;a.update(),setTimeout(u,n)},a={update:function(){e("[data-livestamp]").each(function(){var t=e(this);o(t,t.data("livestamp"))});var n=[];i.each(function(){var r=e(this),i=r.data("livestampdata");if(i===undefined)n.push(this);else if(t.isMoment(i.moment)){var s=r.html(),o=i.moment.fromNow();if(s!=o){var u=e.Event("change.livestamp");r.trigger(u,[s,o]),u.isDefaultPrevented()||r.html(o)}}}),i=i.not(n)},pause:function(){r=!0},resume:function(){r=!1,u()},interval:function(e){if(e===undefined)return n;n=e}},f={add:function(n,r){return typeof r=="number"&&(r*=1e3),r=t(r),t.isMoment(r)&&!isNaN(+r)&&(n.each(function(){o(e(this),r)}),a.update()),n},destroy:function(t){return i=i.not(t),t.each(function(){var n=e(this),r=n.data("livestampdata");if(r===undefined)return t;n.html(r.original?r.original:"").removeData("livestampdata")}),t},isLivestamp:function(e){return e.data("livestampdata")!==undefined}};e.livestamp=a,e(s),e.fn.livestamp=function(e,t){return f[e]||(t=e,e="add"),f[e](this,t)}})(jQuery,moment);