/**
 * Overscroll v1.7.3
 *  A jQuery Plugin that emulates the iPhone scrolling experience in a browser.
 *  http://azoffdesign.com/overscroll
 *
 * Intended for use with the latest jQuery
 *  http://code.jquery.com/jquery-latest.js
 *  
 * Copyright 2013, Jonathan Azoff
 * Licensed under the MIT license.
 *  https://github.com/azoff/overscroll/blob/master/mit.license
 *
 * For API documentation, see the README file
 *  http://azof.fr/pYCzuM
 *
 * Date: Tuesday, March 18th 2013
 */

(function(e,t,n,r,i,s,o,u,a){function d(e,t){t.trigger("overscroll:"+e)}function v(){return(new Date).getTime()}function m(e,t,n){return t.x=e.pageX,t.y=e.pageY,t.time=v(),t.index=n,t}function g(e,t,n,r){var i,s;e&&e.added&&(e.horizontal&&(i=n*(1+t.container.width/t.container.scrollWidth),s=r+t.thumbs.horizontal.top,e.horizontal.css("margin",s+"px 0 0 "+i+"px")),e.vertical&&(i=n+t.thumbs.vertical.left,s=r*(1+t.container.height/t.container.scrollHeight),e.vertical.css("margin",s+"px 0 0 "+i+"px")))}function y(e,t,n){e&&e.added&&!t.persistThumbs&&(n?(e.vertical&&e.vertical.stop(!0,!0).fadeTo("fast",h.thumbOpacity),e.horizontal&&e.horizontal.stop(!0,!0).fadeTo("fast",h.thumbOpacity)):(e.vertical&&e.vertical.fadeTo("fast",0),e.horizontal&&e.horizontal.fadeTo("fast",0)))}function b(e){var t,n="events",r=u._data?u._data(e[0],n):e.data(n);r&&r.click&&(t=r.click.slice(),e.off("click").one("click",function(){return u.each(t,function(t,n){e.click(n)}),!1}))}function w(e){var t=e.data,n=t.thumbs,r=t.options,i=e.type==="mouseenter";y(n,r,i)}function E(e){var t=e.data;t.flags.dragged||g(t.thumbs,t.sizing,this.scrollLeft,this.scrollTop)}function S(e){e.preventDefault();var t=e.data,n=t.options,r=t.sizing,o=t.thumbs,u=t.wheel,a=t.flags,l=e.originalEvent,c=0,p=0,d=0;a.drifting=!1,l.detail?(c=-l.detail,l.detailX&&(p=-l.detailX),l.detailY&&(d=-l.detailY)):l.wheelDelta&&(c=l.wheelDelta/h.wheelTicks,l.wheelDeltaX&&(p=l.wheelDeltaX/h.wheelTicks),l.wheelDeltaY&&(d=l.wheelDeltaY/h.wheelTicks)),c*=n.wheelDelta,p*=n.wheelDelta,d*=n.wheelDelta,u||(t.target.data(f).dragging=a.dragging=!0,t.wheel=u={timeout:null},y(o,n,!0)),n.wheelDirection==="vertical"?this.scrollTop-=c:n.wheelDirection==="horizontal"?this.scrollLeft-=c:(this.scrollLeft-=p,this.scrollTop-=d||c),u.timeout&&s(u.timeout),g(o,r,this.scrollLeft,this.scrollTop),u.timeout=i(function(){t.target.data(f).dragging=a.dragging=!1,y(o,n,t.wheel=null)},h.thumbTimeout)}function x(e){e.preventDefault();var t=e.data,n=e.originalEvent.touches,r=t.options,i=t.sizing,s=t.thumbs,o=t.position,u=t.flags,a=t.target.get(0);n&&n.length&&(e=n[0]),u.dragged||y(s,r,!0),u.dragged=!0,r.direction!=="vertical"&&(a.scrollLeft-=e.pageX-o.x),t.options.direction!=="horizontal"&&(a.scrollTop-=e.pageY-o.y),m(e,t.position),--t.capture.index<=0&&(t.target.data(f).dragging=u.dragging=!0,m(e,t.capture,h.captureThreshold)),g(s,i,a.scrollLeft,a.scrollTop)}function T(e,t,n){var r=t.data,i,s,o,u,a=r.capture,f=r.options,c=r.sizing,p=r.thumbs,m=v()-a.time,y=e.scrollLeft,b=e.scrollTop,w=h.driftDecay;if(m>h.driftTimeout){n(r);return}i=f.scrollDelta*(t.pageX-a.x),s=f.scrollDelta*(t.pageY-a.y),f.direction!=="vertical"&&(y-=i),f.direction!=="horizontal"&&(b-=s),o=i/h.driftSequences,u=s/h.driftSequences,d("driftstart",r.target),r.drifting=!0,l.animate(function E(){if(r.drifting){var t=1,i=-1;r.drifting=!1;if(u>t&&e.scrollTop>b||u<i&&e.scrollTop<b)r.drifting=!0,e.scrollTop-=u,u/=w;if(o>t&&e.scrollLeft>y||o<i&&e.scrollLeft<y)r.drifting=!0,e.scrollLeft-=o,o/=w;g(p,c,e.scrollLeft,e.scrollTop),l.animate(E)}else d("driftend",r.target),n(r)})}function N(e){var t=e.data,n=e.originalEvent.touches,r=t.target,i=t.start=u(e.target),s=t.flags;s.drifting=!1,i.size()&&!i.is(t.options.cancelOn)&&(n||e.preventDefault(),l.overflowScrolling||(r.css("cursor",l.cursor.grabbing),r.data(f).dragging=s.dragging=s.dragged=!1,t.options.dragHold?u(document).on(c.drag,t,x):r.on(c.drag,t,x)),t.position=m(e,{}),t.capture=m(e,{},h.captureThreshold),d("dragstart",r))}function C(e){var t=e.data,n=t.target,r=t.options,i=t.flags,s=t.thumbs,o=function(){s&&!r.hoverThumbs&&y(s,r,!1)};r.dragHold?u(document).unbind(c.drag,x):n.unbind(c.drag,x),t.position&&(d("dragend",n),i.dragging&&!l.overflowScrolling?T(n.get(0),e,o):o()),i.dragging&&!l.overflowScrolling&&t.start&&t.start.is(e.target)&&b(t.start),n.data(f).dragging=t.start=t.capture=t.position=i.dragged=i.dragging=!1,n.css("cursor",l.cursor.grab)}function k(e){return e=u.extend({},p,e),e.direction!=="multi"&&e.direction!==e.wheelDirection&&(e.wheelDirection=e.direction),e.scrollDelta=r.abs(parseFloat(e.scrollDelta)),e.wheelDelta=r.abs(parseFloat(e.wheelDelta)),e.scrollLeft=e.scrollLeft===a?null:r.abs(parseFloat(e.scrollLeft)),e.scrollTop=e.scrollTop===a?null:r.abs(parseFloat(e.scrollTop)),e}function L(e){var t=u(e),n=t.width(),r=t.height(),i=n>=e.scrollWidth?n:e.scrollWidth,s=r>=e.scrollHeight?r:e.scrollHeight,o=i>n||s>r;return{valid:o,container:{width:n,height:r,scrollWidth:i,scrollHeight:s},thumbs:{horizontal:{width:n*n/i,height:h.thumbThickness,corner:h.thumbThickness/2,left:0,top:r-h.thumbThickness},vertical:{width:h.thumbThickness,height:r*r/s,corner:h.thumbThickness/2,left:n-h.thumbThickness,top:0}}}}function A(e,t){var n=u(e),r,i=n.data(f)||{},s=n.attr("style"),o=t?function(){i=n.data(f),r=i.thumbs,s?n.attr("style",s):n.removeAttr("style"),r&&(r.horizontal&&r.horizontal.remove(),r.vertical&&r.vertical.remove()),n.removeData(f).off(c.wheel,S).off(c.start,N).off(c.end,C).off(c.ignored,_)}:u.noop;return u.isFunction(i.remover)?i.remover:o}function O(e,t){return{position:"absolute",opacity:t.persistThumbs?h.thumbOpacity:0,"background-color":"black",width:e.width+"px",height:e.height+"px","border-radius":e.corner+"px",margin:e.top+"px 0 0 "+e.left+"px","z-index":t.zIndex}}function M(e,t,n){var r="<div/>",i={},s=!1;return t.container.scrollWidth>0&&n.direction!=="vertical"&&(s=O(t.thumbs.horizontal,n),i.horizontal=u(r).css(s).prependTo(e)),t.container.scrollHeight>0&&n.direction!=="horizontal"&&(s=O(t.thumbs.vertical,n),i.vertical=u(r).css(s).prependTo(e)),i.added=!!s,i}function _(e){e.preventDefault()}function D(e,t){t=k(t);var n=L(e),r,i={options:t,sizing:n,flags:{dragging:!1},remover:A(e,!0)};if(n.valid||t.ignoreSizing)i.target=e=u(e).css({position:"relative",cursor:l.cursor.grab}).on(c.start,i,N).on(c.end,i,C).on(c.ignored,i,_),t.dragHold?u(document).on(c.end,i,C):i.target.on(c.end,i,C),t.scrollLeft!==null&&e.scrollLeft(t.scrollLeft),t.scrollTop!==null&&e.scrollTop(t.scrollTop),l.overflowScrolling?e.css(l.overflowScrolling,"touch"):e.on(c.scroll,i,E),t.captureWheel&&e.on(c.wheel,i,S),t.showThumbs?l.overflowScrolling?e.css("overflow","scroll"):(e.css("overflow","hidden"),i.thumbs=r=M(e,n,t),r.added&&(g(r,n,e.scrollLeft(),e.scrollTop()),t.hoverThumbs&&e.on(c.hover,i,w))):e.css("overflow","hidden"),e.data(f,i)}function P(e){A(e)()}function H(e){return this.removeOverscroll().each(function(){D(this,e)})}function B(){return this.each(function(){P(this)})}var f="overscroll";t.body===null&&t.documentElement.appendChild(t.createElement("body")),e.getComputedStyle||(e.getComputedStyle=function(e,t){return this.el=e,this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;return t=="float"&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null},this});var l={animate:function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){i(e,1e3/60)};return function(n){t.call(e,n)}}(),overflowScrolling:function(){var n="",r=t.createElement("div"),i=["webkit","moz","o","ms"];t.body.appendChild(r),u.each(i,function(e,t){r.style[t+"OverflowScrolling"]="touch"}),r.style.overflowScrolling="touch";var s=e.getComputedStyle(r);return s.overflowScrolling?n="overflow-scrolling":u.each(i,function(e,t){return!s[t+"OverflowScrolling"]||(n="-"+t+"-overflow-scrolling"),!n}),r.parentNode.removeChild(r),n}(),cursor:function(){var n=t.createElement("div"),r=["webkit","moz"],i="https://mail.google.com/mail/images/2/",s={grab:"url("+i+"openhand.cur), move",grabbing:"url("+i+"closedhand.cur), move"};return t.body.appendChild(n),u.each(r,function(t,r){var i,o="-"+r+"-grab";n.style.cursor=o;var u=e.getComputedStyle(n);return i=u.cursor===o,i&&(s={grab:"-"+r+"-grab",grabbing:"-"+r+"-grabbing"}),!i}),n.parentNode.removeChild(n),s}()},c={drag:"mousemove touchmove",end:"mouseup mouseleave click touchend touchcancel",hover:"mouseenter mouseleave",ignored:"select dragstart drag",scroll:"scroll",start:"mousedown touchstart",wheel:"mousewheel DOMMouseScroll"},h={captureThreshold:3,driftDecay:1.1,driftSequences:22,driftTimeout:100,scrollDelta:15,thumbOpacity:.7,thumbThickness:6,thumbTimeout:400,wheelDelta:20,wheelTicks:120},p={cancelOn:"select,input,textarea",direction:"multi",dragHold:!1,hoverThumbs:!1,scrollDelta:h.scrollDelta,showThumbs:!0,persistThumbs:!1,captureWheel:!0,wheelDelta:h.wheelDelta,wheelDirection:"multi",zIndex:999,ignoreSizing:!1};H.settings=h,u.extend(o,{overscroll:H,removeOverscroll:B})})(window,document,navigator,Math,setTimeout,clearTimeout,jQuery.fn,jQuery);