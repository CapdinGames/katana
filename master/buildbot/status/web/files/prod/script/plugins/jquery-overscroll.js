/**
 * Overscroll v1.7.3
 *  A jQuery Plugin that emulates the iPhone scrolling experience in a browser.
 *  http://azoffdesign.com/overscroll
 *
 * Intended for use with the latest jQuery
 *  http://code.jquery.com/jquery-latest.js
 *  
 * Copyright 2013, Jonathan Azoff
 * Licensed under the MIT license.
 *  https://github.com/azoff/overscroll/blob/master/mit.license
 *
 * For API documentation, see the README file
 *  http://azof.fr/pYCzuM
 *
 * Date: Tuesday, March 18th 2013
 */

(function(e,t,n,r,i,s,o,u,a){function f(e,t){t.trigger("overscroll:"+e)}function l(){return(new Date).getTime()}function c(e,t,n){return t.x=e.pageX,t.y=e.pageY,t.time=l(),t.index=n,t}function h(e,t,n,r){var i,s;e&&e.added&&(e.horizontal&&(i=n*(1+t.container.width/t.container.scrollWidth),s=r+t.thumbs.horizontal.top,e.horizontal.css("margin",s+"px 0 0 "+i+"px")),e.vertical&&(i=n+t.thumbs.vertical.left,s=r*(1+t.container.height/t.container.scrollHeight),e.vertical.css("margin",s+"px 0 0 "+i+"px")))}function p(e,t,n){e&&e.added&&!t.persistThumbs&&(n?(e.vertical&&e.vertical.stop(!0,!0).fadeTo("fast",H.thumbOpacity),e.horizontal&&e.horizontal.stop(!0,!0).fadeTo("fast",H.thumbOpacity)):(e.vertical&&e.vertical.fadeTo("fast",0),e.horizontal&&e.horizontal.fadeTo("fast",0)))}function d(e){var t,n="events",r=u._data?u._data(e[0],n):e.data(n);r&&r.click&&(t=r.click.slice(),e.off("click").one("click",function(){return u.each(t,function(t,n){e.click(n)}),!1}))}function v(e){var t=e.data,n=t.thumbs,r=t.options,i=e.type==="mouseenter";p(n,r,i)}function m(e){var t=e.data;t.flags.dragged||h(t.thumbs,t.sizing,this.scrollLeft,this.scrollTop)}function g(e){e.preventDefault();var t=e.data,n=t.options,r=t.sizing,o=t.thumbs,u=t.wheel,a=t.flags,f=e.originalEvent,l=0,c=0,d=0;a.drifting=!1,f.detail?(l=-f.detail,f.detailX&&(c=-f.detailX),f.detailY&&(d=-f.detailY)):f.wheelDelta&&(l=f.wheelDelta/H.wheelTicks,f.wheelDeltaX&&(c=f.wheelDeltaX/H.wheelTicks),f.wheelDeltaY&&(d=f.wheelDeltaY/H.wheelTicks)),l*=n.wheelDelta,c*=n.wheelDelta,d*=n.wheelDelta,u||(t.target.data(_).dragging=a.dragging=!0,t.wheel=u={timeout:null},p(o,n,!0)),n.wheelDirection==="vertical"?this.scrollTop-=l:n.wheelDirection==="horizontal"?this.scrollLeft-=l:(this.scrollLeft-=c,this.scrollTop-=d||l),u.timeout&&s(u.timeout),h(o,r,this.scrollLeft,this.scrollTop),u.timeout=i(function(){t.target.data(_).dragging=a.dragging=!1,p(o,n,t.wheel=null)},H.thumbTimeout)}function y(e){e.preventDefault();var t=e.data,n=e.originalEvent.touches,r=t.options,i=t.sizing,s=t.thumbs,o=t.position,u=t.flags,a=t.target.get(0);n&&n.length&&(e=n[0]),u.dragged||p(s,r,!0),u.dragged=!0,r.direction!=="vertical"&&(a.scrollLeft-=e.pageX-o.x),t.options.direction!=="horizontal"&&(a.scrollTop-=e.pageY-o.y),c(e,t.position),--t.capture.index<=0&&(t.target.data(_).dragging=u.dragging=!0,c(e,t.capture,H.captureThreshold)),h(s,i,a.scrollLeft,a.scrollTop)}function b(e,t,n){var r=t.data,i,s,o,u,a=r.capture,c=r.options,p=r.sizing,d=r.thumbs,v=l()-a.time,m=e.scrollLeft,g=e.scrollTop,y=H.driftDecay;if(v>H.driftTimeout){n(r);return}i=c.scrollDelta*(t.pageX-a.x),s=c.scrollDelta*(t.pageY-a.y),c.direction!=="vertical"&&(m-=i),c.direction!=="horizontal"&&(g-=s),o=i/H.driftSequences,u=s/H.driftSequences,f("driftstart",r.target),r.drifting=!0,D.animate(function b(){if(r.drifting){var t=1,i=-1;r.drifting=!1;if(u>t&&e.scrollTop>g||u<i&&e.scrollTop<g)r.drifting=!0,e.scrollTop-=u,u/=y;if(o>t&&e.scrollLeft>m||o<i&&e.scrollLeft<m)r.drifting=!0,e.scrollLeft-=o,o/=y;h(d,p,e.scrollLeft,e.scrollTop),D.animate(b)}else f("driftend",r.target),n(r)})}function w(e){var t=e.data,n=e.originalEvent.touches,r=t.target,i=t.start=u(e.target),s=t.flags;s.drifting=!1,i.size()&&!i.is(t.options.cancelOn)&&(n||e.preventDefault(),D.overflowScrolling||(r.css("cursor",D.cursor.grabbing),r.data(_).dragging=s.dragging=s.dragged=!1,t.options.dragHold?u(document).on(P.drag,t,y):r.on(P.drag,t,y)),t.position=c(e,{}),t.capture=c(e,{},H.captureThreshold),f("dragstart",r))}function E(e){var t=e.data,n=t.target,r=t.options,i=t.flags,s=t.thumbs,o=function(){s&&!r.hoverThumbs&&p(s,r,!1)};r.dragHold?u(document).unbind(P.drag,y):n.unbind(P.drag,y),t.position&&(f("dragend",n),i.dragging&&!D.overflowScrolling?b(n.get(0),e,o):o()),i.dragging&&!D.overflowScrolling&&t.start&&t.start.is(e.target)&&d(t.start),n.data(_).dragging=t.start=t.capture=t.position=i.dragged=i.dragging=!1,n.css("cursor",D.cursor.grab)}function S(e){return e=u.extend({},B,e),e.direction!=="multi"&&e.direction!==e.wheelDirection&&(e.wheelDirection=e.direction),e.scrollDelta=r.abs(parseFloat(e.scrollDelta)),e.wheelDelta=r.abs(parseFloat(e.wheelDelta)),e.scrollLeft=e.scrollLeft===a?null:r.abs(parseFloat(e.scrollLeft)),e.scrollTop=e.scrollTop===a?null:r.abs(parseFloat(e.scrollTop)),e}function x(e){var t=u(e),n=t.width(),r=t.height(),i=n>=e.scrollWidth?n:e.scrollWidth,s=r>=e.scrollHeight?r:e.scrollHeight,o=i>n||s>r;return{valid:o,container:{width:n,height:r,scrollWidth:i,scrollHeight:s},thumbs:{horizontal:{width:n*n/i,height:H.thumbThickness,corner:H.thumbThickness/2,left:0,top:r-H.thumbThickness},vertical:{width:H.thumbThickness,height:r*r/s,corner:H.thumbThickness/2,left:n-H.thumbThickness,top:0}}}}function T(e,t){var n=u(e),r,i=n.data(_)||{},s=n.attr("style"),o=t?function(){i=n.data(_),r=i.thumbs,s?n.attr("style",s):n.removeAttr("style"),r&&(r.horizontal&&r.horizontal.remove(),r.vertical&&r.vertical.remove()),n.removeData(_).off(P.wheel,g).off(P.start,w).off(P.end,E).off(P.ignored,k)}:u.noop;return u.isFunction(i.remover)?i.remover:o}function N(e,t){return{position:"absolute",opacity:t.persistThumbs?H.thumbOpacity:0,"background-color":"black",width:e.width+"px",height:e.height+"px","border-radius":e.corner+"px",margin:e.top+"px 0 0 "+e.left+"px","z-index":t.zIndex}}function C(e,t,n){var r="<div/>",i={},s=!1;return t.container.scrollWidth>0&&n.direction!=="vertical"&&(s=N(t.thumbs.horizontal,n),i.horizontal=u(r).css(s).prependTo(e)),t.container.scrollHeight>0&&n.direction!=="horizontal"&&(s=N(t.thumbs.vertical,n),i.vertical=u(r).css(s).prependTo(e)),i.added=!!s,i}function k(e){e.preventDefault()}function L(e,t){t=S(t);var n=x(e),r,i={options:t,sizing:n,flags:{dragging:!1},remover:T(e,!0)};if(n.valid||t.ignoreSizing)i.target=e=u(e).css({position:"relative",cursor:D.cursor.grab}).on(P.start,i,w).on(P.end,i,E).on(P.ignored,i,k),t.dragHold?u(document).on(P.end,i,E):i.target.on(P.end,i,E),t.scrollLeft!==null&&e.scrollLeft(t.scrollLeft),t.scrollTop!==null&&e.scrollTop(t.scrollTop),D.overflowScrolling?e.css(D.overflowScrolling,"touch"):e.on(P.scroll,i,m),t.captureWheel&&e.on(P.wheel,i,g),t.showThumbs?D.overflowScrolling?e.css("overflow","scroll"):(e.css("overflow","hidden"),i.thumbs=r=C(e,n,t),r.added&&(h(r,n,e.scrollLeft(),e.scrollTop()),t.hoverThumbs&&e.on(P.hover,i,v))):e.css("overflow","hidden"),e.data(_,i)}function A(e){T(e)()}function O(e){return this.removeOverscroll().each(function(){L(this,e)})}function M(){return this.each(function(){A(this)})}var _="overscroll";t.body===null&&t.documentElement.appendChild(t.createElement("body")),e.getComputedStyle||(e.getComputedStyle=function(e,t){return this.el=e,this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;return t=="float"&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null},this});var D={animate:function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){i(e,1e3/60)};return function(n){t.call(e,n)}}(),overflowScrolling:function(){var n="",r=t.createElement("div"),i=["webkit","moz","o","ms"];t.body.appendChild(r),u.each(i,function(e,t){r.style[t+"OverflowScrolling"]="touch"}),r.style.overflowScrolling="touch";var s=e.getComputedStyle(r);return s.overflowScrolling?n="overflow-scrolling":u.each(i,function(e,t){return!s[t+"OverflowScrolling"]||(n="-"+t+"-overflow-scrolling"),!n}),r.parentNode.removeChild(r),n}(),cursor:function(){var n=t.createElement("div"),r=["webkit","moz"],i="https://mail.google.com/mail/images/2/",s={grab:"url("+i+"openhand.cur), move",grabbing:"url("+i+"closedhand.cur), move"};return t.body.appendChild(n),u.each(r,function(t,r){var i,o="-"+r+"-grab";n.style.cursor=o;var u=e.getComputedStyle(n);return i=u.cursor===o,i&&(s={grab:"-"+r+"-grab",grabbing:"-"+r+"-grabbing"}),!i}),n.parentNode.removeChild(n),s}()},P={drag:"mousemove touchmove",end:"mouseup mouseleave click touchend touchcancel",hover:"mouseenter mouseleave",ignored:"select dragstart drag",scroll:"scroll",start:"mousedown touchstart",wheel:"mousewheel DOMMouseScroll"},H={captureThreshold:3,driftDecay:1.1,driftSequences:22,driftTimeout:100,scrollDelta:15,thumbOpacity:.7,thumbThickness:6,thumbTimeout:400,wheelDelta:20,wheelTicks:120},B={cancelOn:"select,input,textarea",direction:"multi",dragHold:!1,hoverThumbs:!1,scrollDelta:H.scrollDelta,showThumbs:!0,persistThumbs:!1,captureWheel:!0,wheelDelta:H.wheelDelta,wheelDirection:"multi",zIndex:999,ignoreSizing:!1};O.settings=H,u.extend(o,{overscroll:O,removeOverscroll:M})})(window,document,navigator,Math,setTimeout,clearTimeout,jQuery.fn,jQuery);