/*! iFrame Resizer (iframeSizer.contentWindow.min.js) - v2.4.5 - 2014-05-06
 *  Desc: Include this file in any page being loaded into an iframe
 *        to force the iframe to resize to the content size.
 *  Requires: iframeResizer.min.js on host page.
 *  Copyright: (c) 2014 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(){function t(t,n,r){"addEventListener"in window?t.addEventListener(n,r,!1):"attachEvent"in window&&t.attachEvent("on"+e,r)}function n(e){return Y+"["+et+"] "+e}function r(e){G&&"object"==typeof window.console&&console.log(n(e))}function i(e){"object"==typeof window.console&&console.warn(n(e))}function s(){r("Initialising iFrame"),o(),f(),a("background",j),a("padding",q),v(),p(),l(),m(),d()}function o(){function e(e){return"true"===e?!0:!1}var t=K.substr(Z).split(":");et=t[0],F=void 0!==t[1]?parseInt(t[1],B):F,R=void 0!==t[2]?e(t[2]):R,G=void 0!==t[3]?e(t[3]):G,Q=void 0!==t[4]?parseInt(t[4],B):Q,tt=void 0!==t[5]?e(t[5]):tt,H=void 0!==t[6]?e(t[6]):H,I=t[7],$=void 0!==t[8]?t[8]:$,j=t[9],q=t[10]}function u(e,t){return-1!==t.indexOf("-")&&(i("Negative CSS value ignored for "+e),t=""),t}function a(e,t){void 0!==t&&""!==t&&"null"!==t&&(document.body.style[e]=t,r("Body "+e+' set to "'+t+'"'))}function f(){void 0===I&&(I=F+"px"),u("margin",I),a("margin",I)}function l(){document.documentElement.style.height="",document.body.style.height="",r('HTML & body height set to "auto"')}function c(){t(window,"resize",function(){L("resize","Window resized")})}function h(){t(window,"click",function(){L("click","Window clicked")})}function p(){V!==$&&($ in at||(i($+" is not a valid option for heightCalculationMethod."),$="bodyScroll"),r('Height calculation method set to "'+$+'"'))}function d(){!0===H?(c(),h(),b()):r("Auto Resize disabled")}function v(){var e=document.createElement("div");e.style.clear="both",e.style.display="block",document.body.appendChild(e)}function m(){tt&&(r("Enable public methods"),window.parentIFrame={close:function(){L("close","parentIFrame.close()",0,0)},getId:function(){return et},reset:function(){M("parentIFrame.size")},sendMessage:function(e,t){_(0,0,"message",e,t)},setHeightCalculationMethod:function(e){$=e,p()},setTargetOrigin:function(e){r("Set targetOrigin: "+e),rt=e},size:function(e,t){var n=""+(e?e:"")+(t?","+t:"");A(),L("size","parentIFrame.size("+n+")",e,t)}})}function g(){0!==Q&&(r("setInterval: "+Q+"ms"),setInterval(function(){L("interval","setInterval: "+Q)},Math.abs(Q)))}function y(e){function n(e){(void 0===e.height||void 0===e.width||0===e.height||0===e.width)&&(r("Attach listerner to "+e.src),t(e,"load",function(){L("imageLoad","Image loaded")}))}e.forEach(function(e){if("attributes"===e.type&&"src"===e.attributeName)n(e.target);else if("childList"===e.type){var t=e.target.querySelectorAll("img");Array.prototype.forEach.call(t,function(e){n(e)})}})}function b(){function e(){var e=document.querySelector("body"),n={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},i=new t(function(e){L("mutationObserver","mutationObserver: "+e[0].target+" "+e[0].type),y(e)});r("Enable MutationObserver"),i.observe(e,n)}var t=window.MutationObserver||window.WebKitMutationObserver;t?0>Q?g():e():(i("MutationObserver not supported in this browser!"),g())}function w(){function e(e){function t(e){var t=/^\d+(px)?$/i;if(t.test(e))return parseInt(e,B);var r=n.style.left,i=n.runtimeStyle.left;return n.runtimeStyle.left=n.currentStyle.left,n.style.left=e||0,e=n.style.pixelLeft,n.style.left=r,n.runtimeStyle.left=i,e}var n=document.body,r=0;return"defaultView"in document&&"getComputedStyle"in document.defaultView?(r=document.defaultView.getComputedStyle(n,null),r=null!==r?r[e]:0):r=t(n.currentStyle[e]),parseInt(r,B)}return document.body.offsetHeight+e("marginTop")+e("marginBottom")}function E(){return document.body.scrollHeight}function S(){return document.documentElement.offsetHeight}function x(){return document.documentElement.scrollHeight}function T(){return[w(),E(),S(),x()]}function N(){return Math.max.apply(null,T())}function C(){return Math.min.apply(null,T())}function k(){return Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)}function L(e,t,n,i){function s(){e in{reset:1,resetPage:1,init:1}||r("Trigger event: "+t)}function o(){W=p,ut=d,_(W,ut,e)}function u(){return st&&e in U}function a(){return W!==p||R&&ut!==d}function f(){return!(e in{init:1,interval:1,size:1})}function l(){return $ in nt}function c(){r("No change in size detected")}function h(){f()&&l()?M(t):e in{interval:1}||(s(),c())}var p=void 0!==n?n:at[$](),d=void 0!==i?i:k();u()?r("Trigger event cancelled: "+e):a()?(s(),A(),o()):h()}function A(){st||(st=!0,r("Trigger event lock on")),clearTimeout(ot),ot=setTimeout(function(){st=!1,r("Trigger event lock off"),r("--")},z)}function O(e){W=at[$](),ut=k(),_(W,ut,e)}function M(e){var t=$;$=V,r("Reset trigger event: "+e),A(),O("reset"),$=t}function _(e,t,n,i,s){function o(){void 0===s?s=rt:r("Message targetOrigin: "+s)}function u(){var o=e+":"+t,u=et+":"+o+":"+n+(void 0!==i?":"+i:"");r("Sending message to host page ("+u+")"),it.postMessage(Y+u,s)}o(),u()}function D(){return"iFrameResize"in window}function P(e){function t(){return Y===(""+e.data).substr(0,Z)}t()&&(X?(K=e.data,s(),L("init","Init message from host page"),X=!1,setTimeout(function(){J=!1},z)):"reset"===e.data.split("]")[1]?J?r("Page reset ignored by init"):(r("Page size reset by host page"),O("resetPage")):e.data===K||D()||i("Unexpected message ("+e.data+")"))}var H=!0,B=10,j="",F=0,I="",q="",R=!1,U={resize:1,click:1},z=64,W=1,X=!0,V="offset",$=V,J=!0,K="",Q=32,G=!1,Y="[iFrameSizer]",Z=Y.length,et="",tt=!1,nt={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},rt="*",it=window.parent,st=!1,ot=null,ut=1,at={offset:w,bodyOffset:w,bodyScroll:E,documentElementOffset:S,scroll:x,documentElementScroll:x,max:N,min:C,grow:N};t(window,"message",P)}();