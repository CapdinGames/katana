define(["jquery","project/realtimePages","helpers"],function(e,t,n){var r;return r={init:function(r){function o(e){sock&&sock.send(e)}function u(r){e("#tb-root").length!=0&&t.frontPage(r);if(n.getCurrentPage()==="#builddetail_page"){var i=e("#stepList > li");t.buildDetail(r,i)}if(n.getCurrentPage()==="#builders_page"){var s=e(".tablesorter-js tbody > tr");t.buildersPage(r)}}function a(e){u(e)}window.sock=null;var i,s=e("body").attr("data-realTimeServer");i=s,console.log(e("body").attr("data-realTimeServer")),"WebSocket"in window?sock=new WebSocket(i):"MozWebSocket"in window?sock=new MozWebSocket(i):(a("Browser does not support WebSocket!"),window.location="http://autobahn.ws/unsupportedbrowser"),sock&&(sock.onopen=function(){console.log(n.getJsonUrl()),o(n.getJsonUrl()),a("Connected to "+i)},sock.onclose=function(e){a("Connection closed (wasClean = "+e.wasClean+", code = "+e.code+", reason = '"+e.reason+"')"),sock=null,console.log("closed")},sock.onmessage=function(e){a(e.data)})}},r});