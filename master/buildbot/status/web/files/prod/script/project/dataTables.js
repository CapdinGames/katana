define(["datatables-plugin","helpers","text!templates/popups.html","text!templates/buildqueue.html","text!templates/buildslaves.html","mustache"],function(e,t,n,r,i,s){var o;return o={init:function(){var e=$(".tablesorter-js"),o=[];e.each(function(e){var u=[],a={bPaginate:!1,bLengthChange:!1,bFilter:!1,bSort:!0,bInfo:!1,bAutoWidth:!1,sDom:'<"table-wrapper"t>',bRetrieve:!0,asSorting:!0,bServerSide:!1,bSearchable:!0,aaSorting:[],iDisplayLength:50,bStateSave:!0};$(this).hasClass("input-js")&&(a.bFilter=!0,a.oLanguage={sSearch:""},a.sDom='<"top"flip><"table-wrapper"t><"bottom"pi>'),$("> thead th",this).each(function(e){$(this).hasClass("no-tablesorter-js")?u.push({bSortable:!1}):u.push(null)});if($(this).hasClass("buildqueue-table")){var f=s.render(n,{preloader:"true"});$("body").append(f),a.aaSorting=[[2,"asc"]],a.aoColumns=[{mData:"builderName"},{mData:"sources"},{mData:"reason"},{mData:"slaves"},{mData:"brid",bSortable:!1}],a.aaData=o,a.aoColumnDefs=[{sClass:"txt-align-left",aTargets:[0]},{aTargets:[1],sClass:"txt-align-left",mRender:function(e,t,n){var i=n.sources.length,o=s.render(r,{showsources:!0,sources:n.sources,codebase:n.codebase,sourcesLength:i});return o}},{aTargets:[2],sClass:"txt-align-left",mRender:function(e,n,i){var o=moment.unix(i.submittedAt).format("MMMM Do YYYY, H:mm:ss"),u=t.getTime(i.submittedAt,null),a=s.render(r,{reason:i.reason,requested:o,submittedAt:i.submittedAt});return a},fnCreatedCell:function(e,n,r,i,s){t.startCounter($(e).find(".waiting-time"),r.submittedAt)}},{aTargets:[3],sClass:"txt-align-right",mRender:function(e,t,n){var i=n.slaves.length,o=s.render(r,{showslaves:!0,slaves:e,slavelength:i});return o}},{aTargets:[4],sClass:"select-input",mRender:function(e,t,n){var i=s.render(r,{input:"true",brid:n.brid});return i}}]}else if($(this).hasClass("buildslaves-tables")){var f=s.render(n,{preloader:"true"});$("body").append(f),a.aoColumns=[{mData:"friendly_name"},{mData:"builders"},{mData:"connected"},{mData:"lastMessage"}],a.aaData=o,a.aoColumnDefs=[{aTargets:[0],mRender:function(e,t,n){var r=s.render(i,{buildersPopup:!0,friendly_name:n.friendly_name,buildbotversion:n.version,admin:n.admin,builders:n.builders});return r}},{aTargets:[1],mRender:function(e,t,n){var r;return n.name!=undefined?r=n.name:r="Not Available",r}},{aTargets:[2],fnCreatedCell:function(e,t,n,r,i){if(n.connected===!1)$(e).addClass("offline").text("Not connected");else if(n.connected===!0&&n.runningBuilds.length===0)$(e).addClass("idle").text("idle");else if(n.connected===!0&&n.runningBuilds.length>0){var s="Running "+n.runningBuilds.length+" build(s)";$(e).addClass("building").text(s)}}},{aTargets:[3],mRender:function(e,t,n){var r=" ("+moment().utc(n.lastMessage).format("MMM Do YYYY, H:mm:ss")+")",o=moment().utc(n.lastMessage).fromNow(),u=n.lastMessage!=0?o+r:"",a=n.lastMessage!=0?!0:null,f=s.render(i,{showTimeago:a,timeAgo:u,lastMessageTimeAgo:o,lastMessageDate:r});return f}}]}else a.aoColumns=u;$(this).hasClass("tools-js")&&(a.bPaginate=!0,a.bLengthChange=!0,a.bInfo=!0,a.bFilter=!0,a.oLanguage={sSearch:"",sLengthMenu:'Entries per page<select><option value="10">10</option><option value="25">25</option><option value="50">50</option><option value="100">100</option><option value="-1">All</option></select>'},a.sDom='<"top"flip><"table-wrapper"t><"bottom"pi>');var l=$(this).dataTable(a),c=$(".dataTables_filter input");$("#builders_page").length&&window.location.search!=""&&t.codeBaseBranchOverview(),c.attr("placeholder","Filter results").focus()})}},o});