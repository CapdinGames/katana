define(["jquery","dataTables","timeElements","text!hbCells","extend-moment","handlebars","helpers","moment","popup","URIjs/URI"],function(t,e,n,i,a,r,s,l,u,o){var d=Handlebars.compile(i),c={getPropertyOnData:function(t,e){return void 0===e?void 0:"string"==typeof e||e instanceof String?t[e]:e(t)},buildIsHistoric:function(e){var n=!1,i=!1;return t.each(e,function(t,e){e.length>0&&(2===e.length&&"revision"===e[0]&&0!==e[1].length?n=!0:3===e.length&&"buildLatestRev"===e[0]&&"Trigger"===e[2]&&(i=!0))}),n===!0&&i===!1}},f={revision:function(t,e,n){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,i,a){var r=c.getPropertyOnData(a,e),s=!1;return void 0!==a.properties&&(s=c.buildIsHistoric(a.properties)),d({revisionCell:!0,sourceStamps:r,history_build:s,hide_branch:n})}}},buildID:function(t){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,e,n){return d({buildID:!0,data:n})}}},buildStatus:function(e,n){return{aTargets:[e],sClass:void 0===n?"txt-align-left":n,mRender:function(t,e,n){return d({buildStatus:!0,build:n})},fnCreatedCell:function(e,n,i){t(e).removeClass().addClass(i.results_text)}}},builderName:function(t,e){return{aTargets:[t],sClass:void 0===e?"txt-align-right":e,mRender:function(t,e,n){return d({showBuilderName:!0,data:n})}}},shortTime:function(t,e){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,n,i){var r=c.getPropertyOnData(i,e);return a.getDateFormatted(r)}}},slaveName:function(t,e,n,i){return{aTargets:[t],sClass:void 0===i?"txt-align-left":i,mRender:function(t,i,a){var r=c.getPropertyOnData(a,e),s=c.getPropertyOnData(a,n);return d({slaveName:!0,name:r,url:s})}}},slaveStatus:function(e){return{aTargets:[e],mRender:function(t,e,n){var i,a=!1;return void 0===n.connected||n.connected===!1?i="Offline":n.connected===!0&&void 0===n.runningBuilds?i="Idle":n.connected===!0&&n.runningBuilds.length>0&&(i=n.runningBuilds.length+" build(s) ",a=!0),d({slaveStatus:!0,showStatusTxt:i,showSpinIcon:a})},fnCreatedCell:function(e,n,i){if(void 0===i.connected)t(e).addClass("offline");else if(i.connected===!0&&void 0===i.runningBuilds)t(e).addClass("idle");else if(i.connected===!0&&i.runningBuilds.length>0){var a=0;void 0!==i.runningBuilds&&(t.each(i.runningBuilds,function(t,e){void 0!==e.eta&&e.eta<0&&(a+=1)}),a=a>0?a:!1);var r=t(e).addClass("building").find("a.popup-btn-json-js");u.initJSONPopup(r,{showRunningBuilds:i}),a&&(t(e).removeClass("building").addClass("overtime tooltip").attr("title","One or more builds on overtime"),s.tooltip(t(e)))}}}},buildProgress:function(e,i){return{aTargets:[e],sClass:"txt-align-left",mRender:function(t,e,n){return d({buildProgress:!0,showPending:!i,pendingBuilds:i?void 0:n.pendingBuilds,currentBuilds:i?[n]:n.currentBuilds,builderName:n.name})},fnCreatedCell:function(e){var i=t(e).find(".percent-outer-js");t.each(i,function(e,i){var a=t(i);n.addProgressBarElem(a,a.attr("data-starttime"),a.attr("data-etatime"))}),u.initPendingPopup(t(e).find(".pending-popup"))}}},stopBuild:function(t){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,e,n){var i=o(n.url.path);return i=i.path(i.path()+"/stop"),d({stopBuild:!0,data:n,stopURL:i})}}},buildLength:function(t,e){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,n,i){var a=c.getPropertyOnData(i,e);if(void 0!==a){var r=l.duration(1e3*(a[1]-a[0]));return 3===a.length&&(r=l.duration(1e3*(a[2]-a[0]))),"{0}m {1}s ".format(r.minutes(),r.seconds())}return"N/A"}}}},m={buildTableInit:function(n,i,a){var r={};return r.aoColumns=[{mData:null,sTitle:"#",sWidth:"5%"},{mData:null,sTitle:"Date",sWidth:"10%"},{mData:null,sTitle:"Revision",sWidth:"30%"},{mData:null,sTitle:"Result",sWidth:"30%",sClass:""},{mData:null,sTitle:"Build Time",sWidth:"15%"},{mData:null,sTitle:"Slave",sWidth:"10%"}],r.fnRowCallback=function(e,n){void 0!==n.properties&&c.buildIsHistoric(n.properties)&&t(e).addClass("italic")},r.aoColumnDefs=[f.buildID(0),f.shortTime(1,function(t){return t.times[0]}),f.revision(2,"sourceStamps",a),f.buildStatus(3),f.buildLength(4,"times"),f.slaveName(5,function(t){return void 0!==t.slave_friendly_name?t.slave_friendly_name:t.slave},"slave_url","txt-align-right")],i===!0&&(r.aoColumns[1].sWidth="10%",r.aoColumns[2].sWidth="25%",r.aoColumns[3].sWidth="30%",r.aoColumns[4].sWidth="10%",r.aoColumns[5].sWidth="20%",r.aoColumns[5].sTitle="Builder",r.aoColumnDefs.splice(5,1),r.aoColumnDefs.push(f.builderName(5))),e.initTable(n,r)},rtfGenericTableProcess:function(t,e){n.clearTimeObjects(t),t.fnClearTable();try{t.fnAddData(e),n.updateTimeObjects()}catch(i){}}};return{table:m,cell:f}});
//# sourceMappingURL=rtGenericTable.js.map