define(["jquery","dataTables","timeElements","text!hbCells","extend-moment","handlebars","helpers","moment","popup","URIjs/URI"],function(t,e,n,i,r,a,s,l,u,o){var d=Handlebars.compile(i),c={getPropertyOnData:function(t,e){return void 0===e?void 0:"string"==typeof e||e instanceof String?t[e]:e(t)},buildIsHistoric:function(e){var n=!1,i=!1;return t.each(e,function(t,e){e.length>0&&(2===e.length&&"revision"===e[0]&&0!==e[1].length?n=!0:3===e.length&&"buildLatestRev"===e[0]&&"Trigger"===e[2]&&(i=!0))}),n===!0&&i===!1}},f={revision:function(t,e,n){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,i,r){var a=c.getPropertyOnData(r,e),s=!1;return void 0!==r.properties&&(s=c.buildIsHistoric(r.properties)),d({revisionCell:!0,sourceStamps:a,history_build:s,hide_branch:n})}}},buildID:function(t){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,e,n){return d({buildID:!0,data:n})}}},buildStatus:function(e,n){return{aTargets:[e],sClass:void 0===n?"txt-align-left":n,mRender:function(t,e,n){return d({buildStatus:!0,build:n})},fnCreatedCell:function(e,n,i){t(e).removeClass().addClass(i.results_text)}}},builderName:function(t,e){return{aTargets:[t],sClass:void 0===e?"txt-align-right":e,mRender:function(t,e,n){return d({showBuilderName:!0,data:n})}}},shortTime:function(t,e){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,n,i){var a=c.getPropertyOnData(i,e);return r.getDateFormatted(a)}}},slaveName:function(t,e,n,i){return{aTargets:[t],sClass:void 0===i?"txt-align-left":i,mRender:function(t,i,r){var a=c.getPropertyOnData(r,e),s=c.getPropertyOnData(r,n);return d({slaveName:!0,name:a,url:s})}}},slaveStatus:function(e){return{aTargets:[e],mRender:function(t,e,n){var i,r=!1;return void 0===n.connected||n.connected===!1?i="Offline":n.connected!==!0||void 0!==n.runningBuilds&&0!==n.runningBuilds.length?n.connected===!0&&n.runningBuilds.length>0&&(i=n.runningBuilds.length+" build(s) ",r=!0):i="Idle",d({slaveStatus:!0,showStatusTxt:i,showSpinIcon:r})},fnCreatedCell:function(e,n,i){if(void 0===i.connected)t(e).addClass("offline");else if(i.connected===!0&&void 0===i.runningBuilds)t(e).addClass("idle");else if(i.connected===!0&&i.runningBuilds.length>0){var r=!1;void 0!==i.runningBuilds&&t.each(i.runningBuilds,function(t,e){void 0!==e.eta&&e.eta<0&&(r=!0)});var a=t(e).addClass("building").find("a.popup-btn-json-js");u.initJSONPopup(a,{showRunningBuilds:i}),r&&(t(e).removeClass("building").addClass("overtime tooltip").attr("title","One or more builds on overtime"),s.tooltip(t(e)))}}}},buildProgress:function(e,i){return{aTargets:[e],sClass:"txt-align-left",mRender:function(t,e,n){return d({buildProgress:!0,showPending:!i,pendingBuilds:i?void 0:n.pendingBuilds,currentBuilds:i?[n]:n.currentBuilds,builderName:n.name})},fnCreatedCell:function(e){var i=t(e).find(".percent-outer-js");t.each(i,function(e,i){var r=t(i);n.addProgressBarElem(r,r.attr("data-starttime"),r.attr("data-etatime"))}),u.initPendingPopup(t(e).find(".pending-popup"))}}},stopBuild:function(t){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,e,n){var i=o(n.url.path);return i=i.path(i.path()+"/stop"),d({stopBuild:!0,data:n,stopURL:i})}}},buildLength:function(t,e){return{aTargets:[t],sClass:"txt-align-left",mRender:function(t,n,i){var r=c.getPropertyOnData(i,e);if(void 0!==r){if("sort"===n)return 3===r.length?r[2]-r[0]:r[1]-r[0];var a=l.duration(1e3*(r[1]-r[0]));return 3===r.length&&(a=l.duration(1e3*(r[2]-r[0]))),a.hours()>0?"{0}h {1}m {2}s".format(a.hours(),a.minutes(),a.seconds()):"{0}m {1}s".format(a.minutes(),a.seconds())}return"sort"===n?0:"N/A"}}}},m={buildTableInit:function(n,i,r){var a={};return a.aoColumns=[{mData:null,sTitle:"#",sWidth:"10%"},{mData:null,sTitle:"Date",sWidth:"15%"},{mData:null,sTitle:"Revision",sWidth:"20%"},{mData:null,sTitle:"Result",sWidth:"30%",sClass:"txt-align-left"},{mData:null,sTitle:"Build Time",sWidth:"10%"},{mData:null,sTitle:"Slave",sWidth:"15%"}],a.fnRowCallback=function(e,n){void 0!==n.properties&&c.buildIsHistoric(n.properties)&&t(e).addClass("italic")},a.aoColumnDefs=[f.buildID(0),f.shortTime(1,function(t){return t.times[0]}),f.revision(2,"sourceStamps",r),f.buildStatus(3),f.buildLength(4,"times"),f.slaveName(5,function(t){return void 0!==t.slave_friendly_name?t.slave_friendly_name:t.slave},"slave_url","txt-align-right")],i===!0&&(a.aoColumns[1].sWidth="10%",a.aoColumns[2].sWidth="25%",a.aoColumns[3].sWidth="30%",a.aoColumns[4].sWidth="10%",a.aoColumns[5].sWidth="20%",a.aoColumns[5].sTitle="Builder",a.aoColumnDefs.splice(5,1),a.aoColumnDefs.push(f.builderName(5))),e.initTable(n,a)},rtfGenericTableProcess:function(t,e){n.clearTimeObjects(t),s.clearChildEvents(t),t.fnClearTable();try{t.fnAddData(e),n.updateTimeObjects()}catch(i){}}};return{table:m,cell:f}});
//# sourceMappingURL=rtGenericTable.js.map