define(["jquery","realtimePages","helpers","popup","handlebars","mustache","text!templates/build.handlebars","text!templates/builders.mustache"],function(e,t,n,r,i,s,o,u){var a,f=e("#stepList").find("> li"),l=Handlebars.compile(o),c=!1,h=!1;return Handlebars.registerHelper("buildCSSClass",function(e){return n.getCssClassFromStatus(e)}),a={init:function(){var e=t.defaultRealtimeFunctions();e.build=a.processBuildDetailPage,t.initRealtime(e)},processBuildDetailPage:function(t){var r=Object.keys(t);r.length==1&&(t=t[r[0]]);var i=t.times[0],s=t.times[1],o=s!==null,u=t.eta;a.refreshIfRequired(o),a.processBuildResult(t,i,u,o),a.processSteps(t),s===null&&h==0&&(n.startCounter(e("#elapsedTimeJs"),i),h=!0)},processBuildResult:function(t,r,i,o){var a=e("#buildResult"),f="";i!=0&&(f=s.render(u,{progressBar:!0,etaStart:r,etaCurrent:i}));var c={buildResults:!0,b:t,buildIsFinished:o,progressBar:f},h=l(c);a.html(h);var p=a.find(".percent-outer-js");p.addClass("build-detail-progress"),n.delegateToProgressBar(p)},processSteps:function(t){var r="",i=e("#stepList");e.each(t.steps,function(e,t){var i=t.isStarted,s=t.isFinished,o=t.results[0];i?i&&!s&&(o=7):o=8;var u=n.getCssClassFromStatus(o),a=t.times[0],f=t.times[1],c=n.getTime(a,f),h={step:!0,index:e,stepStarted:t.isStarted,run_time:c,css_class:u,s:t,url:t.url};r+=l(h)}),i.html(r)},refreshIfRequired:function(e){c==1&&e&&(window.location=window.location+"#finished",window.location.reload()),c=!0}},a});