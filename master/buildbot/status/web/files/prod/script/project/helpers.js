define(["jquery","screensize","text!templates/popups.mustache","mustache","extend-moment","timeElements"],function(t,e,n,o,i,a){var r,s={SUCCESS:"success",WARNINGS:"warnings",FAILURE:"failure",SKIPPED:"skipped",EXCEPTION:"exception",RETRY:"retry",CANCELED:"exception",NOT_REBUILT:"not_rebuilt",RUNNING:"running",NOT_STARTED:"not_started",None:""};return String.prototype.format=function(){var t=arguments;return this.replace(/\{(\d+)\}/g,function(e,n){return void 0!==t[n]?t[n]:e})},Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)},r={init:function(){r.setCurrentItem(),r.authorizeUser(),t("#buildslave_page").length&&r.displaySum(t("#currentJobs"),t("#runningBuilds_onBuildslave").find("li")),r.menuItemWidth(e.isMediumScreen()),t(window).resize(function(){r.menuItemWidth(e.isMediumScreen())}),t(function(){var e=/chrome/.test(navigator.userAgent.toLowerCase()),n=/firefox/.test(navigator.userAgent.toLowerCase()),o=-1!==navigator.platform.toUpperCase().indexOf("WIN");e&&t("body").addClass("chrome"),o&&t("body").addClass("win"),n&&t("body").addClass("firefox")}),r.toolTip(".ellipsis-js"),r.parseReasonString(),t("#authUserBtn").click(function(){r.eraseCookie("fullName1","","eraseCookie")}),r.tooltip(t(".tooltip"))},randomImage:function(t){var e=["48273828.jpg"];t.attr("src","images/"+e[Math.floor(Math.random()*e.length)])},tooltip:function(n){n.hover(function(n){var o=t(this),i=t('<div class="tooltip-cont" />');this.t=this.title,this.title="";var a=n.pageY+20,r=n.pageX+5;t(n.target).click(function(){i.remove()}),e.isMediumScreen()&&o.hasClass("responsive-tooltip")?i.html(this.t).appendTo("body").css({top:a,right:28}).fadeIn("fast"):i.html(this.t).appendTo("body").css({top:a,left:r}).fadeIn("fast")},function(){this.title=this.t;var e=t(".tooltip-cont");e.fadeOut("fast",function(){t(this).remove()})})},authorizeUser:function(){window.location;""===r.getCookie("BuildBotSession")&&(window.location="/login")},setCurrentItem:function(){var e=window.location.pathname.split("/");t(".top-menu a").each(function(){this.href.split("/");(this.id===e[1].trim().toLowerCase()||"home"===this.id&&0===e[1].trim().toLowerCase().length)&&t(this).parent().addClass("selected")})},jCenter:function(e){var n=t(window).height(),o=t(window).width(),i=e.outerHeight(),a=e.outerWidth();return e.css(i+5>n?{top:5+t(window).scrollTop()+"px",height:n-60}:{top:(n-i)/2+t(window).scrollTop()+"px",height:"auto"}),e.css("left",(o-a)/2+t(window).scrollLeft()+"px"),e},parseReasonString:function(){t(".codebases-list .reason-txt").each(function(){var e=t(this).text().trim();"A build was forced by '':"===e&&t(this).remove()})},selectBuildsAction:function(e,i,a,r){function s(n){var o=e.dataTable();return t("body").append(u).show(),n+="&ajax=true",t.ajax({type:"POST",url:a,data:n,success:function(t){i===!1&&(o.fnClearTable(),o.fnAddData(t)),l.prop("checked",!1),u.remove()}}),!1}if(void 0!==e||(e=t("#tablesorterRt"),0!==e.length)){var c=o.render(n,{preloader:"true"}),u=t(c),l=t("#selectall");l.click(function(){var n=e.dataTable().fnGetNodes();t(".fi-js",n).prop("checked",this.checked)}),t("#submitBtn").click(function(n){n.preventDefault();var o=e.dataTable(),i=o.fnGetNodes(),a=t(".fi-js",i),c="";a.each(function(){t(this).is(":checked")&&(c+=r+t(this).val()+"&")});var u=c.slice(0,-1);""!==u&&s(u)}),e.delegate(".force-individual-js","click",function(e){e.preventDefault();var n=t(this).prev().prev().val(),o=r+n;s(o)})}},updateBuilders:function(){t.ajax({url:"/json/builders/?filter=0",dataType:"json",type:"GET",cache:!1,success:function(e){function n(e){var n=0;return t.each(e,function(){n+=parseFloat(this)||0}),n}var o=[],i=[],a=[];t.each(e,function(t,e){o.push(t),i.push(e.pendingBuilds),"building"===e.state&&a.push(e.currentBuilds)}),t("#pendingBuilds").text(n(i))}}),t.ajax({url:"/json/slaves/?filter=0",dataType:"json",type:"GET",cache:!1,success:function(e){var n=[];t.each(e,function(t){n.push(t)}),t("#slavesNr").text(n.length)}})},codeBaseBranchOverview:function(e){var n=decodeURIComponent(window.location.search),o=n.split("&"),i=t('<div class="border-table-holder col-xs-10"><div id="overScrollJS" class="inner-table-holder"><table class="codebase-branch-table"><tr class="codebase"><th>Codebase</th></tr><tr class="branch"><th>Branch</th></tr></table></div></div>');i.appendTo(e),t(o).each(function(e){var n=this.split("=");if(n[0].indexOf("_branch")>0){var o=this.split("_branch")[0];0===e&&(o=this.replace("?","").split("_branch")[0]);var i=this.split("=")[1];t("tr.codebase").append("<td>"+o+"</td>"),t("tr.branch").append("<td>"+i+"</td>")}})},menuItemWidth:function(e){if(e){var n=0;t(".breadcrumbs-nav li").each(function(){n+=t(this).outerWidth()}),t(".breadcrumbs-nav").width(n+100)}else t(".breadcrumbs-nav").width("")},toolTip:function(e){t(e).parent().hover(function(){var n=t(e,this).attr("data-txt"),o=t("<div/>").addClass("tool-tip").text(n);t(this).append(t(o).css({top:t(e,this).position().top-10,left:t(e,this).position().left-20}).show())},function(){t(".tool-tip").remove()}),t(document).bind("click touchstart",function(e){t(".tool-tip").remove(),t(this).unbind(e)})},displaySum:function(t,e){t.text(e.length)},setCookie:function(t,e,n){var o=new Date,i=new Date(o.getTime()+2592e6),a=void 0===n?i.toGMTString():"Thu, 01 Jan 1970 00:00:00 GMT;";document.cookie=t+"="+e+"; path=/; expires="+a},inDOM:function(e){return t.contains(document.documentElement,e[0])},delegateToProgressBar:function(e){t.each(e,function(e,n){var o=t(n);a.addProgressBarElem(o,o.attr("data-starttime"),o.attr("data-etatime"))})},verticalProgressBar:function(t,e){t.height("{0}%".format(e))},getTime:function(t,e){null===e&&(e=Math.round(+new Date/1e3));var n=e-t,o=Math.round(n),i=0===Math.floor(n/86400)?"":Math.floor(n/86400)+" days ",a=0===Math.floor(n/3600)?"":Math.floor(n/3600)%24+" hours ",r=0===Math.floor(o/60)?"":Math.floor(o/60)%60+" mins, ",s=o-60*Math.floor(o/60)+" secs ";return i+a+r+s},getResult:function(t){var e=["success","warnings","failure","skipped","exception","retry","canceled"];return e[t]},getSlavesResult:function(t,e){return t===!1?"Not connected":e.length>0?"Running":"idle"},getClassName:function(t,e){var n=r.getSlavesResult(t,e);return"Not connected"===n?"status-td offline":"Running"===n?"status-td building":"status-td idle"},getCurrentPage:function(){return document.getElementsByTagName("body")[0].id},hasfinished:function(){var e=!1,n=t("#isFinished").attr("data-isfinished");return void 0===n&&(e=!1),n===!0&&(e=!0),e},isRealTimePage:function(){var e=!1,n=["buildslaves_page","buildslavedetail_page","builderdetail_page","builddetail_page","buildqueue_page","projects_page","home_page","builders_page","jsonhelp_page","usersettings_page"],o=r.getCurrentPage();return t.each(n,function(t,n){n===o&&(e=!0)}),e},getCookie:function(t){var e=new RegExp(t+"=([^;]+)"),n=e.exec(document.cookie);return null!==n?decodeURI(n[1]):""},eraseCookie:function(t,e,n){r.setCookie(t,e,n)},closePopup:function(e,n){var o=t(".close-btn").add(document);o.bind("click touchstart",function(i){(!t(i.target).closest(e).length||t(i.target).closest(".close-btn").length)&&(void 0===n?e.remove():e.slideUp("fast",function(){o.unbind(i)}),o.unbind(i))})},urlHasCodebases:function(){return Object.keys(r.codebasesFromURL({})).length>0},codebasesFromURL:function(e){var n=window.location.search.substring(1),o=n.split("&");return t.each(o,function(t,n){var o=n.split("=");o[0].indexOf("_branch")>=0&&(e[o[0]]=o[1])}),e},urlParamsToString:function(e){var n=[];return t.each(e,function(t,e){n.push(t+"="+e)}),n.join("&")},getCssClassFromStatus:function(t){var e=Object.keys(s).map(function(t){return s[t]});return e[t]},setIFrameSize:function(t){if(t){var e=t.contentWindow||t.contentDocument.parentWindow;e.document.body&&(t.height=e.document.documentElement.scrollHeight||e.document.body.scrollHeight,t.width=e.document.documentElement.scrollWidth||e.document.body.scrollWidth)}},objectPropertiesToArray:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n}}});
//# sourceMappingURL=helpers.js.map