define(["jquery","screensize","text!templates/popups.mustache","mustache","extend-moment","timeElements"],function(t,e,n,i,o,a){var s,r={},c={SUCCESS:[0,"success"],WARNINGS:[1,"warnings"],FAILURE:[2,"failure"],SKIPPED:[3,"skipped"],EXCEPTION:[4,"exception"],RETRY:[5,"retry"],CANCELED:[6,"exception"],NOT_REBUILT:[7,"not_rebuilt"],DEPENDENCY_FAILURE:[8,"dependency_failure"],RUNNING:[9,"running"],NOT_STARTED:[10,"not_started"],None:""};return t.each(c,function(t,e){r[t]=e[0]}),String.prototype.format=function(){var t=arguments;return this.replace(/\{(\d+)\}/g,function(e,n){return void 0!==t[n]?t[n]:e})},Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)},s={init:function(){s.setCurrentItem(),s.authorizeUser(),t("#buildslave_page").length&&s.displaySum(t("#currentJobs"),t("#runningBuilds_onBuildslave").find("li")),s.menuItemWidth(e.isMediumScreen()),t(window).resize(function(){s.menuItemWidth(e.isMediumScreen())}),t(function(){var e=/chrome/.test(navigator.userAgent.toLowerCase()),n=/firefox/.test(navigator.userAgent.toLowerCase()),i=-1!==navigator.platform.toUpperCase().indexOf("WIN");e&&t("body").addClass("chrome"),i&&t("body").addClass("win"),n&&t("body").addClass("firefox")}),s.toolTip(".ellipsis-js"),s.parseReasonString(),t("#authUserBtn").click(function(){s.eraseCookie("fullName1","","eraseCookie")}),s.tooltip(t(".tooltip"))},randomImage:function(t){var e=["48273828.jpg"];t.attr("src","images/"+e[Math.floor(Math.random()*e.length)])},tooltip:function(n){n.hover(function(n){var i=t(this),o=t('<div class="tooltip-cont" />');this.t=this.title,this.title="";var a=n.pageY+20,s=n.pageX+5;t(n.target).click(function(){o.remove()}),e.isMediumScreen()||!i.hasClass("responsive-tooltip")?o.html(this.t).appendTo("body").css({top:a,left:s}).fadeIn("fast"):i.hasClass("responsive-tooltip")&&o.html(this.t).appendTo("body").css({top:a,right:28}).fadeIn("fast")},function(){this.title=this.t;var e=t(".tooltip-cont");e.fadeOut("fast",function(){t(this).remove()})})},authorizeUser:function(){window.location;""===s.getCookie("BuildBotSession")&&(window.location="/login")},setCurrentItem:function(){var e=window.location.pathname.split("/");t(".top-menu a").each(function(){this.href.split("/");(this.id===e[1].trim().toLowerCase()||"home"===this.id&&0===e[1].trim().toLowerCase().length)&&t(this).parent().addClass("selected")})},jCenter:function(e){var n=t(window).height(),i=t(window).width(),o=e.outerHeight(),a=e.outerWidth();return e.css(o+5>n?{top:5+t(window).scrollTop()+"px",height:n-60}:{top:(n-o)/2+t(window).scrollTop()+"px",height:"auto"}),e.css("left",(i-a)/2+t(window).scrollLeft()+"px"),e},parseReasonString:function(){t(".codebases-list .reason-txt").each(function(){var e=t(this).text().trim();"A build was forced by '':"===e&&t(this).remove()})},selectBuildsAction:function(e,o,a,s){function r(n){var i=e.dataTable();return t("body").append(u).show(),n+="&ajax=true",t.ajax({type:"POST",url:a,data:n,success:function(t){o===!1&&(i.fnClearTable(),i.fnAddData(t)),l.prop("checked",!1),u.remove()}}),!1}if(void 0!==e||(e=t("#tablesorterRt"),0!==e.length)){var c=i.render(n,{preloader:"true"}),u=t(c),l=t("#selectall");l.click(function(){var n=e.dataTable().fnGetNodes();t(".fi-js",n).prop("checked",this.checked)}),t("#submitBtn").click(function(n){n.preventDefault();var i=e.dataTable(),o=i.fnGetNodes(),a=t(".fi-js",o),c="";a.each(function(){t(this).is(":checked")&&(c+=s+t(this).val()+"&")});var u=c.slice(0,-1);""!==u&&r(u)}),e.delegate(".force-individual-js","click",function(e){e.preventDefault();var n=t(this).prev().val(),i=s+n;r(i)})}},updateBuilders:function(){t.ajax({url:"/json/builders/?filter=0",dataType:"json",type:"GET",cache:!1,success:function(e){function n(e){var n=0;return t.each(e,function(){n+=parseFloat(this)||0}),n}var i=[],o=[],a=[];t.each(e,function(t,e){i.push(t),o.push(e.pendingBuilds),"building"===e.state&&a.push(e.currentBuilds)}),t("#pendingBuilds").text(n(o))}}),t.ajax({url:"/json/slaves/?filter=0",dataType:"json",type:"GET",cache:!1,success:function(e){var n=[];t.each(e,function(t){n.push(t)}),t("#slavesNr").text(n.length)}})},codeBaseBranchOverview:function(e){var n=decodeURIComponent(window.location.search),i=n.split("&"),o=t('<div class="border-table-holder col-xs-10"><div id="overScrollJS" class="inner-table-holder"><table class="codebase-branch-table"><tr class="codebase"><th>Codebase</th></tr><tr class="branch"><th>Branch</th></tr></table></div></div>');o.appendTo(e),t(i).each(function(e){var n=this.split("=");if(n[0].indexOf("_branch")>0){var i=this.split("_branch")[0];0===e&&(i=this.replace("?","").split("_branch")[0]);var o=this.split("=")[1];t("tr.codebase").append("<td>"+i+"</td>"),t("tr.branch").append("<td>"+o+"</td>")}})},menuItemWidth:function(e){if(e)t(".breadcrumbs-nav").width("");else{var n=0;t(".breadcrumbs-nav li").each(function(){n+=t(this).outerWidth()}),t(".breadcrumbs-nav").width(n+100)}},toolTip:function(e){t(e).parent().hover(function(){var n=t(e,this).attr("data-txt"),i=t("<div/>").addClass("tool-tip").text(n);t(this).append(t(i).css({top:t(e,this).position().top-10,left:t(e,this).position().left-20}).show())},function(){t(".tool-tip").remove()}),t(document).bind("click touchstart",function(e){t(".tool-tip").remove(),t(this).unbind(e)})},displaySum:function(t,e){t.text(e.length)},setCookie:function(t,e,n){var i=new Date,o=new Date(i.getTime()+2592e6),a=void 0===n?o.toGMTString():"Thu, 01 Jan 1970 00:00:00 GMT;";document.cookie=t+"="+e+"; path=/; expires="+a},inDOM:function(e){return t.contains(document.documentElement,e[0])},delegateToProgressBar:function(e){t.each(e,function(e,n){var i=t(n);a.addProgressBarElem(i,i.attr("data-starttime"),i.attr("data-etatime"))})},verticalProgressBar:function(t,e){t.height("{0}%".format(e))},getTime:function(t,e){null===e&&(e=Math.round(+new Date/1e3));var n=e-t,i=Math.round(n),o=0===Math.floor(n/86400)?"":Math.floor(n/86400)+" days ",a=0===Math.floor(n/3600)?"":Math.floor(n/3600)%24+" hours ",s=0===Math.floor(i/60)?"":Math.floor(i/60)%60+" mins, ",r=i-60*Math.floor(i/60)+" secs ";return o+a+s+r},getResult:function(t){var e=["success","warnings","failure","skipped","exception","retry","canceled"];return e[t]},getSlavesResult:function(t,e){return t===!1?"Not connected":e.length>0?"Running":"idle"},getClassName:function(t,e){var n=s.getSlavesResult(t,e);return"Not connected"===n?"status-td offline":"Running"===n?"status-td building":"status-td idle"},getCurrentPage:function(){return document.getElementsByTagName("body")[0].id},hasfinished:function(){var e=!1,n=t("#isFinished").attr("data-isfinished");return void 0===n&&(e=!1),n===!0&&(e=!0),e},isRealTimePage:function(){var e=!1,n=["buildslaves_page","buildslavedetail_page","builderdetail_page","builddetail_page","buildqueue_page","projects_page","home_page","builders_page","jsonhelp_page","usersettings_page"],i=s.getCurrentPage();return t.each(n,function(t,n){n===i&&(e=!0)}),e},getCookie:function(t){var e=new RegExp(t+"=([^;]+)"),n=e.exec(document.cookie);return null!==n?decodeURI(n[1]):""},eraseCookie:function(t,e,n){s.setCookie(t,e,n)},closePopup:function(e,n){var i=t(".close-btn").add(document);i.bind("click touchstart",function(o){(!t(o.target).closest(e).length||t(o.target).closest(".close-btn").length)&&(void 0===n?e.remove():e.slideUp("fast",function(){i.unbind(o)}),i.unbind(o))})},urlHasCodebases:function(){return Object.keys(s.codebasesFromURL({})).length>0},codebasesFromURL:function(e){var n=window.location.search.substring(1),i=n.split("&");return t.each(i,function(t,n){var i=n.split("=");i[0].indexOf("_branch")>=0&&(e[i[0]]=i[1])}),e},urlParamsToString:function(e){var n=[];return t.each(e,function(t,e){n.push(t+"="+e)}),n.join("&")},getCssClassFromStatus:function(t){var e=Object.keys(c).map(function(t){return c[t]});return e[t][1]},setIFrameSize:function(t){if(t){var e=t.contentWindow||t.contentDocument.parentWindow;e.document.body&&(t.height=e.document.documentElement.scrollHeight||e.document.body.scrollHeight,t.width=e.document.documentElement.scrollWidth||e.document.body.scrollWidth)}},objectPropertiesToArray:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n},clearChildEvents:function(t){t.find("*").addBack().off()},cssClassesEnum:r}});
//# sourceMappingURL=helpers.js.map