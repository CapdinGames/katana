{% from 'build_line.html' import build_table %}
{% import 'forms.html' as forms %}
{% import 'submenu.html' as submenu %}

{% extends "layout.html" %}

{% block submenu %}
  {{submenu.buildsubmenu(active_page="codebases", pathNum=2, builderName='', buildNumber='', stepName='')}}
{% endblock %}

{% block content %}

<div id="formWrapper">
  <div class="fl-right m-right10">
      <select autocomplete="off" id="commonBranch_select" name='common_branches' class="select-tools-common">
        <option></option>
      </select>
    </div>
<form id="getForm" method="get" name="select_codebases" action="/projects/{{selectedproject|urlencode}}/builders">
  
    <input value="Show" class="grey-btn fl-right m-bottom10 var-2" type="submit" />
    

<table class="table-2 no-bg tablesorter-js tablesorter">
   <thead>
  <tr>
    <th>Codebase</th>
    <th>Url</th>
    <th class="no-tablesorter-js" id="selectorWidth">Branches</th>
  </tr>
</thead>
<tbody>
{% for cb in codebases %}
    {% for cbkey, codebase in cb.iteritems() %}
  <tr>
    <td>
        {{cbkey}}
    </td>
    <td>
      {{codebase['repository']}}
    </td>
    <td class="txt-align-right">

      <select name='{{cbkey}}_branch' class="select-tools-js" >

         {% for b in codebase['branch'] %}
          {% if request.args|length > 0 and cbkey+'_branch' in request.args.keys() %}
            <option value="{{b}}" {{(b in request.args[cbkey+'_branch']) and "selected" or ""}}>

          {% else %}
            <option value="{{b}}" {{(b in codebase['defaultbranch']) and "selected" or ""}}>

          {% endif %}

            {{ b }}
            </option>
          {% endfor %}
      </select>
    </td>
  </tr>
 {% endfor %}
{% endfor %}
</tbody>
</table>

</form>
</div>
{% endblock %}